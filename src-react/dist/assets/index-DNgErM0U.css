:root{--bg-body: #F2F4F7;--bg-paper: #FFFFFF;--text-main: #2C3E50;--text-secondary: #95A5A6;--theme-primary: #00B894;--theme-bg-light: #F0FDF4;--highlight-color: rgba(0, 184, 148, .2);--accent-gold: #D4AF37;--accent-action: #5D3FD3;--lv-easy: #27AE60;--lv-mid: #2980B9;--lv-hard: #C0392B}body{margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background-color:var(--bg-body);height:100vh;display:flex;overflow:hidden;transition:background-color .5s ease}#root,.app-container{display:flex;width:100%;height:100%}body.mode-flow{--theme-primary: #00B894;--theme-bg-light: #F0FDF4;--highlight-color: rgba(0, 184, 148, 0)}body.mode-learn{--theme-primary: #2980B9;--theme-bg-light: #EAF2F8;--highlight-color: rgba(41, 128, 185, .15)}.mode-switcher{display:flex;background:#f0f2f5;padding:4px;border-radius:12px;margin-bottom:20px;width:100%}.mode-btn{flex:1;border:none;background:transparent;padding:8px;border-radius:8px;color:#95a5a6;cursor:pointer;font-weight:600;transition:all .3s;display:flex;align-items:center;justify-content:center;gap:6px}.mode-btn.active{background:#fff;color:var(--theme-primary);box-shadow:0 2px 5px #0000000d}.floating-controls{position:fixed;top:20px;right:30px;z-index:1000;display:flex;flex-direction:column;align-items:flex-end;gap:8px;padding:10px;margin:-10px;transition:all .3s ease}.control-collapsed-view{background:#ffffffe6;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);padding:8px 16px;border-radius:20px;box-shadow:0 4px 15px #00000014;border:1px solid rgba(0,0,0,.05);font-weight:600;font-size:.9rem;color:var(--text-main);display:flex;align-items:center;gap:6px;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);transform-origin:top right;white-space:nowrap}.control-collapsed-view:before{content:"‚öôÔ∏è";font-size:1rem}.floating-controls:hover .control-collapsed-view{opacity:0;transform:scale(.8) translateY(-10px);pointer-events:none;position:absolute;top:10px;right:10px}.control-expanded-content{display:flex;flex-direction:column;align-items:flex-end;gap:8px;opacity:0;transform:scale(.95) translateY(-5px);transform-origin:top right;pointer-events:none;transition:all .3s cubic-bezier(.4,0,.2,1);position:absolute;top:10px;right:10px}.floating-controls:hover .control-expanded-content{opacity:1;transform:scale(1) translateY(0);pointer-events:auto;position:relative;top:0;right:0}.control-inner{display:flex;gap:12px;background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);padding:8px;border-radius:16px;box-shadow:0 8px 30px #0000001f;border:1px solid rgba(0,0,0,.05)}.mode-switcher.compact{margin:0;width:auto;background:#f0f2f5;padding:3px;border-radius:10px}.mode-switcher.compact .mode-btn{padding:6px 12px;font-size:.9rem}.import-btn{width:36px;height:36px;border-radius:10px;border:none;background:#f0f2f5;color:#555;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:1.1rem;transition:all .2s}.import-btn:hover{background:#e1e5eb;transform:scale(1.05)}.level-capsule.small{width:200px}.reader-panel{flex:1;background-color:var(--bg-paper);height:100%;overflow-y:auto;position:relative;padding:0 80px;scroll-behavior:smooth;transition:flex .6s cubic-bezier(.2,.8,.2,1),padding-right .5s cubic-bezier(.2,.8,.2,1)}.copilot-panel{width:0;flex:0;overflow:hidden;background-color:#f7f9fc;border-left:1px solid rgba(0,0,0,.08);display:flex;flex-direction:column;height:100%;box-shadow:-5px 0 20px #00000005;transition:flex .6s cubic-bezier(.2,.8,.2,1),opacity .3s;opacity:0}body.mode-learn .reader-panel{flex:6}body.mode-learn .copilot-panel{flex:4;opacity:1}body.mode-learn .dashboard-content{padding-top:140px}.reader-content{max-width:700px;margin:0 auto;padding-top:100px;padding-bottom:300px;position:relative;transition:margin .6s ease,transform .6s cubic-bezier(.2,.8,.2,1)}body.mode-flow .reader-content{margin:0 auto}body.ask-mode .reader-content{max-width:580px;margin-left:30px;margin-right:auto}.reader-content{transition:max-width .4s ease,margin .4s ease}.focus-marker{position:absolute;left:-40px;width:4px;background-color:var(--accent-gold);border-radius:4px;transition:top .4s cubic-bezier(.2,.8,.2,1),height .3s ease,opacity .3s ease;box-shadow:0 0 15px #d4af3799;opacity:0;z-index:100}.focus-marker.active{opacity:1;animation:pulse-gold 2s infinite}@keyframes pulse-gold{0%{box-shadow:0 0 10px #d4af3766}50%{box-shadow:0 0 20px #d4af37cc}to{box-shadow:0 0 10px #d4af3766}}.book-title{font-family:Georgia,serif;font-size:2.8rem;color:var(--text-main);margin-bottom:3rem;font-weight:700;letter-spacing:-1px}.paragraph{margin-bottom:1.5rem;position:relative;transition:opacity .4s;padding:10px 15px;border-radius:8px}.paragraph:hover{background-color:#00000003}.para-text{font-family:Georgia,serif;font-size:1.4rem;line-height:1.8;color:#4a4a4a;transition:color .3s}.paragraph.active .para-text{color:#000;font-weight:500}.paragraph.active{background-color:#fffc;box-shadow:0 4px 20px #0000000d;transform:scale(1.02);z-index:10}.blur-word{filter:blur(5px);background:#eee;transition:all .3s ease;cursor:help}.blur-word:hover{filter:blur(0);background:transparent}.inline-trans{margin-top:12px;font-family:-apple-system,PingFang SC,sans-serif;font-size:.95rem;line-height:1.6;color:#555;background:#f8f9fa;padding:12px 16px;border-radius:0 8px 8px;border-left:3px solid var(--accent-gold);display:none;opacity:0;transform:translateY(-5px);transition:all .3s ease}.inline-trans.show{display:block;opacity:1;transform:translateY(0)}.trans-toggle{display:inline-flex;align-items:center;justify-content:center;width:20px;height:20px;border-radius:4px;background:#eee;color:#999;font-size:.7rem;cursor:pointer;transition:all .2s;opacity:0;transform:scale(.8);position:absolute;right:-35px;top:40px}.paragraph:hover .trans-toggle,.paragraph.active .trans-toggle{opacity:1;transform:scale(1)}.trans-toggle:hover{background:var(--accent-gold);color:#fff}.smart-word{border-radius:4px;cursor:pointer;transition:all .2s;position:relative}body.mode-flow .smart-word.has-card{border-bottom:2px solid rgba(0,184,148,.3)}body.mode-flow .smart-word.has-card:hover{background-color:#00b8941a}body.mode-learn .smart-word.has-card{background-color:var(--highlight-color);border-bottom:2px solid transparent}body.mode-learn .smart-word.has-card:hover,body.mode-learn .smart-word.highlighted{background-color:#2980b94d;border-bottom-color:var(--theme-primary);color:#000}.peek-tooltip{position:absolute;bottom:100%;left:50%;transform:translate(-50%) translateY(-5px);background:#000000d9;color:#fff;padding:4px 8px;border-radius:4px;font-size:.8rem;white-space:nowrap;pointer-events:none;opacity:0;transition:opacity .1s;z-index:1000}.smart-word:hover .peek-tooltip{opacity:1}.smart-word.interactive-word{cursor:pointer}.smart-word.interactive-word:active{transform:scale(.98)}.smart-word.interactive-word .peek-tooltip{transition:opacity .15s,background .2s}.inline-def-tag{font-size:.75rem;color:#888;font-style:italic;font-family:PingFang SC,-apple-system,sans-serif;margin-left:2px}.ambient-card{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 4px 12px #0000000d;animation:fadeIn .5s}.ambient-img{width:100%;height:160px;object-fit:cover}.ambient-info{padding:15px}.ambient-title{font-weight:700;color:#2d3436;margin-bottom:5px}.ambient-desc{font-size:.85rem;color:#636e72;line-height:1.5}.control-header{display:none}.level-capsule{background:#f0f2f5;border-radius:12px;padding:4px;display:flex;position:relative;width:100%;max-width:340px}.capsule-indicator{position:absolute;top:4px;bottom:4px;left:4px;width:calc(33.33% - 5px);background:#fff;border-radius:8px;box-shadow:0 2px 6px #0000001a;transition:transform .3s cubic-bezier(.4,0,.2,1);z-index:1}.capsule-btn{flex:1;border:none;background:transparent;font-size:.85rem;font-weight:600;color:#95a5a6;cursor:pointer;z-index:2;position:relative;padding:10px 0;transition:color .3s}.level-capsule[data-active="1"] .capsule-indicator{transform:translate(0);border-top:2px solid var(--lv-easy)}.level-capsule[data-active="2"] .capsule-indicator{transform:translate(100%);border-top:2px solid var(--lv-mid)}.level-capsule[data-active="3"] .capsule-indicator{transform:translate(200%);border-top:2px solid var(--lv-hard)}.level-capsule button.active-text{color:#2c3e50}.level-info{font-size:.75rem;color:#aaa;margin-top:5px;font-weight:500}.dashboard-content{flex:1;min-height:0;padding:20px 30px 40px;overflow-y:auto;overflow-x:hidden;display:flex;flex-direction:column;gap:20px}.dashboard-header{background:linear-gradient(135deg,#667eea,#764ba2);border-radius:12px;padding:12px 16px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 4px 12px #667eea33;margin-bottom:4px}.current-para-info{flex:1}.para-preview{color:#fff;font-size:.85rem;line-height:1.4;opacity:.95;font-family:Georgia,serif}.btn-reanalyze-global{background:#ffffff40;color:#fff;border:1px solid rgba(255,255,255,.3);padding:6px 14px;border-radius:8px;font-size:.8rem;font-weight:600;cursor:pointer;transition:all .2s;white-space:nowrap;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.btn-reanalyze-global:hover:not(:disabled){background:#ffffff59;border-color:#ffffff80;transform:translateY(-1px)}.btn-reanalyze-global:active:not(:disabled){transform:translateY(0)}.btn-reanalyze-global:disabled{opacity:.5;cursor:not-allowed}.module-card{background:#fff;border-radius:12px;border:1px solid rgba(0,0,0,.05);overflow:hidden;animation:slideUp .3s ease-out;box-shadow:0 4px 12px #00000005;flex-shrink:0}.module-header{padding:12px 16px;background:linear-gradient(to right,#fafbfc,#fff);border-bottom:1px solid #F0F0F0;font-size:.7rem;font-weight:700;color:#b0b0b0;text-transform:uppercase;letter-spacing:.5px;display:flex;justify-content:space-between}.knowledge-item{padding:16px;border-bottom:1px dashed #EEE;cursor:pointer;position:relative;transition:background .2s}.knowledge-item:hover{background:#fafafa}.knowledge-item:last-child{border-bottom:none}.knowledge-item.active-card-highlight{background-color:#e3f2fd;border-left:4px solid var(--theme-primary)}.k-guess-mode .k-def,.k-guess-mode .k-context{display:none}.k-guess-mode .k-clue{display:block}.k-guess-mode:after{content:"Tap to Reveal";position:absolute;right:15px;top:50%;transform:translateY(-50%);font-size:.7rem;color:var(--accent-action);background:#5d3fd31a;padding:4px 8px;border-radius:12px}.k-reveal-mode .k-clue{display:none}.k-reveal-mode .k-def,.k-reveal-mode .k-context{display:block;animation:fadeIn .3s}.k-top{display:flex;align-items:baseline;gap:8px;margin-bottom:6px}.k-word{font-size:1.15rem;font-weight:700;color:#2c3e50}.k-ipa{font-size:.85rem;color:#999;font-family:Lucida Sans Unicode,sans-serif}.k-clue{display:none;font-style:italic;color:#666;font-size:.9rem;border-left:2px solid var(--accent-action);padding-left:8px;margin-top:5px}.k-clue:before{content:"ü§î Hint: ";font-style:normal;font-weight:700}.k-def{font-size:.95rem;color:#333;font-weight:500;margin-bottom:4px}.k-context{font-size:.85rem;color:#7f8c8d;background:#f2f4f7;padding:8px;border-radius:6px}.insight-body{padding:16px;font-size:.95rem;line-height:1.6;color:#555}.insight-tag{display:inline-block;padding:2px 6px;border-radius:4px;font-size:.7rem;margin-bottom:8px;color:#fff;background:#2c3e50}.xray-card{border-left:3px solid var(--theme-primary);background:linear-gradient(135deg,#f8fafc,#f0f4f8)}.xray-body{padding:16px}.xray-pattern{display:flex;flex-direction:column;gap:6px;margin-bottom:12px}.xray-pattern-label{font-size:.75rem;font-weight:700;color:#64748b}.xray-pattern-value{font-size:1.05rem;font-weight:600;color:var(--theme-primary);background:#2980b91a;padding:6px 12px;border-radius:6px;display:inline-block}.xray-breakdown{font-size:.9rem;color:#475569;background:#f1f5f9;padding:8px 12px;border-radius:6px;margin-bottom:12px;font-family:PingFang SC,-apple-system,sans-serif}.xray-keywords{margin-bottom:12px}.xray-keywords-label{font-size:.75rem;font-weight:700;color:#64748b;display:block;margin-bottom:8px}.xray-keyword-item{display:flex;align-items:center;gap:10px;margin-bottom:6px;padding:6px 0;border-bottom:1px dashed #e2e8f0}.xray-keyword-item:last-child{border-bottom:none;margin-bottom:0}.xray-keyword-word{font-weight:700;color:#2563eb;font-family:Georgia,serif;background:#2563eb1a;padding:2px 8px;border-radius:4px}.xray-keyword-role{font-size:.85rem;color:#64748b;font-family:PingFang SC,-apple-system,sans-serif}.xray-explanation{margin-top:12px;padding:12px;background:#d4af371a;border-radius:8px;border-left:3px solid var(--accent-gold);display:flex;align-items:flex-start;gap:8px}.xray-explanation-icon{font-size:1.1rem;flex-shrink:0}.xray-explanation-text{font-size:.9rem;color:#5a5a5a;line-height:1.5;font-family:PingFang SC,-apple-system,sans-serif}.btn-debate{width:100%;padding:12px;border:2px solid #EEE;background:#fff;color:var(--accent-action);font-weight:600;border-radius:8px;cursor:pointer;margin-top:10px;transition:all .2s;display:flex;align-items:center;justify-content:center;gap:8px}.btn-debate:hover{border-color:var(--accent-action);background:#5d3fd30d}@keyframes slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}.ask-trigger{position:absolute;right:-40px;top:0;width:30px;height:30px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:1.2rem;opacity:0;transition:all .3s ease;border-radius:50%;background:transparent;z-index:100}.ask-trigger:hover{background:#ffffff80;transform:scale(1.1);box-shadow:0 2px 8px #0000000d}.paragraph.active .ask-trigger{opacity:.4;top:10px}.paragraph:hover .ask-trigger,.ask-trigger:hover{opacity:1}.ask-bubble{position:absolute;right:-320px;top:0;width:300px;background:#fffffffa;-webkit-backdrop-filter:blur(15px);backdrop-filter:blur(15px);border-radius:12px;box-shadow:0 10px 40px #00000026;border:1px solid rgba(0,0,0,.05);padding:15px;z-index:2000;display:none;flex-direction:column;gap:10px;animation:popIn .2s cubic-bezier(.175,.885,.32,1.275);max-height:400px;overflow:hidden}.ask-bubble.show{display:flex}.ask-bubble-header{display:flex;justify-content:space-between;align-items:center;padding-bottom:10px;border-bottom:1px solid #eee;margin-bottom:5px;font-weight:600;font-size:.9rem;color:#475569}.ask-bubble-close{background:none;border:none;font-size:1.4rem;color:#94a3b8;cursor:pointer;padding:0 4px;line-height:1;transition:all .2s}.ask-bubble-close:hover{color:#ef4444;transform:scale(1.1)}body.mode-learn .ask-bubble{position:fixed;right:20px;top:100px;left:auto}@keyframes popIn{0%{opacity:0;transform:scale(.9) translate(-10px)}to{opacity:1;transform:scale(1) translate(0)}}.ask-input{width:100%;border:1px solid #EEE;background:#fafafa;padding:8px 12px;border-radius:8px;font-family:inherit;font-size:.9rem;outline:none;resize:none;box-sizing:border-box}.ask-input:focus{background:#fff;border-color:var(--theme-primary)}.ask-history{max-height:200px;overflow-y:auto;display:flex;flex-direction:column;gap:8px;font-size:.85rem}.msg-user{align-self:flex-end;background:var(--theme-primary);color:#fff;padding:6px 10px;border-radius:8px 8px 0;max-width:80%}.msg-ai{align-self:flex-start;background:#f0f2f5;color:#333;padding:6px 10px;border-radius:0 8px 8px;max-width:90%;line-height:1.5}.suggestion-chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px;padding-bottom:5px}.suggestion-chips::-webkit-scrollbar{display:none}.ask-chip{background:#fff;border:1px solid #E1E5EB;border-radius:16px;padding:6px 12px;font-size:.8rem;color:#555;cursor:pointer;white-space:nowrap;transition:all .2s;box-shadow:0 2px 4px #00000008;flex-shrink:0}.ask-chip:hover{background:var(--theme-primary);color:#fff;border-color:var(--theme-primary);transform:translateY(-1px);box-shadow:0 4px 8px #0000001a}.msg-ai p{margin:.5em 0}.msg-ai p:first-child{margin-top:0}.msg-ai p:last-child{margin-bottom:0}.msg-ai strong{color:#2c3e50;font-weight:700}.msg-ai ul,.msg-ai ol{margin:.5em 0;padding-left:1.4em}.msg-ai li{margin-bottom:.3em}.msg-thinking{align-self:flex-start;color:#aaa;font-size:.8rem;font-style:italic;margin-left:10px;animation:pulse 1s infinite}@keyframes pulse{0%{opacity:.5}50%{opacity:1}to{opacity:.5}}.inline-def-tag{font-size:.8em;color:#7f8c8d;font-weight:400;margin-left:4px;vertical-align:baseline;font-family:-apple-system,PingFang SC,sans-serif;pointer-events:none}.modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:#0006;display:none;align-items:center;justify-content:center;z-index:3000;opacity:0;transition:opacity .3s ease}.modal-overlay.show{opacity:1}.modal-content{background:#fff;width:90%;max-width:500px;padding:30px;border-radius:20px;box-shadow:0 20px 60px #0003;position:relative;transform:scale(.95);transition:transform .2s ease}.modal-overlay.show .modal-content{transform:scale(1)}.modal-content h2{margin-top:0;margin-bottom:20px;font-weight:600}.import-tabs{display:flex;gap:15px;margin-bottom:20px;border-bottom:2px solid #F0F2F5}.tab-btn{background:none;border:none;padding:10px 0;cursor:pointer;font-weight:500;color:#999;opacity:.7;border-bottom:2px solid transparent;margin-bottom:-2px}.tab-btn.active{color:var(--theme-primary);border-color:var(--theme-primary);opacity:1}.tab-pane{display:none}.tab-pane.active{display:block}#importText,#importUrl{width:100%;padding:15px;border:1px solid #EEE;border-radius:12px;background:#fafafa;font-family:inherit;font-size:.95rem;box-sizing:border-box}#importText{height:150px;resize:none}#importText:focus,#importUrl:focus{outline:none;border-color:var(--theme-primary);background:#fff}.hint-text{font-size:.85rem;color:#888;margin-top:8px}.modal-actions{display:flex;justify-content:flex-end;gap:12px;margin-top:25px}.btn-secondary{padding:10px 20px;border:none;background:#f0f2f5;color:#555;border-radius:10px;cursor:pointer;font-weight:500}.btn-primary{padding:10px 24px;border:none;background:var(--theme-primary);color:#fff;border-radius:10px;cursor:pointer;font-weight:600;box-shadow:0 4px 12px #0984e34d}.loading-overlay{position:absolute;top:0;left:0;width:100%;height:100%;background:#ffffffe6;display:flex;flex-direction:column;align-items:center;justify-content:center;border-radius:20px}.loading-overlay.hidden{display:none}.spinner{width:40px;height:40px;border:4px solid #f3f3f3;border-top:4px solid var(--theme-primary);border-radius:50%;animation:spin 1s linear infinite;margin-bottom:15px}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
