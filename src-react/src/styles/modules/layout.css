/* --- Theme Classes --- */
body.mode-flow {
    --theme-primary: #00B894;
    /* Emerald Green */
    --theme-bg-light: #F0FDF4;
    --highlight-color: rgba(0, 184, 148, 0);
    /* Invisible highlight base */
}

body.mode-learn {
    --theme-primary: #2980B9;
    /* Royal Blue */
    --theme-bg-light: #EAF2F8;
    --highlight-color: rgba(41, 128, 185, 0.15);
}

/* ================= Dynamic Layout ================= */

/* Initial State: Flow Mode (Full Screen) */
.reader-panel {
    flex: 1;
    /* Take full width */
    background-color: var(--bg-paper);
    height: 100%;
    overflow-y: auto;
    position: relative;
    padding: 0 80px;
    scroll-behavior: smooth;
    transition: flex 0.6s cubic-bezier(0.2, 0.8, 0.2, 1), padding-right 0.5s cubic-bezier(0.2, 0.8, 0.2, 1);
    /* Smooth resize */
}

.copilot-panel {
    width: 0;
    flex: 0;
    /* Shut completely */
    overflow: hidden;
    background-color: #F7F9FC;
    border-left: 1px solid rgba(0, 0, 0, 0.08);
    display: flex;
    flex-direction: column;
    height: 100%;
    box-shadow: -5px 0 20px rgba(0, 0, 0, 0.02);
    transition: flex 0.6s cubic-bezier(0.2, 0.8, 0.2, 1), opacity 0.3s;
    opacity: 0;
}

/* Learn Mode State (Split Screen) */
body.mode-learn .reader-panel {
    flex: 6;
    /* Returns to 60% */
}

body.mode-learn .copilot-panel {
    flex: 4;
    /* Returns to 40% */
    opacity: 1;
}

/* Adjust reader content margin for centering */
.reader-content {
    max-width: 700px;
    margin: 0 auto;
    padding-top: 100px;
    padding-bottom: 300px;
    position: relative;
    /* Anchor for absolute elements like Focus Marker */
    transition: margin 0.6s ease, transform 0.6s cubic-bezier(0.2, 0.8, 0.2, 1), max-width 0.4s ease;
}

/* In Flow mode, ensure it stays centered visually nicely */
body.mode-flow .reader-content {
    margin: 0 auto;
}

/* Ask AI Layout Shift - Only activate when space is insufficient */
/* Note: ask-mode class is only added by JS when viewport space is tight */

body.ask-mode .reader-content {
    max-width: 580px;
    margin-left: 30px;
    margin-right: auto;
}

/* Fix overlap with floating controls in Learn Mode */
body.mode-learn .dashboard-content {
    padding-top: 140px;
}